{"openapi":"3.1.0","info":{"title":"PRM Service","description":"Patient Relationship Management - Journey orchestration and communications","version":"0.1.0"},"paths":{"/health":{"get":{"tags":["Health"],"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/prm/journeys":{"post":{"tags":["Journeys"],"summary":"Create Journey","description":"Create a new journey definition\n\nJourney defines the stages and automation for patient engagement.\nCan be marked as default to auto-apply when conditions are met.","operationId":"create_journey_api_v1_prm_journeys_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Journeys"],"summary":"List Journeys","description":"List journey definitions with filters","operationId":"list_journeys_api_v1_prm_journeys_get","parameters":[{"name":"tenant_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Tenant Id"}},{"name":"journey_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Journey Type"}},{"name":"is_default","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Default"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/journeys/{journey_id}":{"get":{"tags":["Journeys"],"summary":"Get Journey","description":"Get journey definition with stages","operationId":"get_journey_api_v1_prm_journeys__journey_id__get","parameters":[{"name":"journey_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Journey Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Journeys"],"summary":"Update Journey","description":"Update journey definition","operationId":"update_journey_api_v1_prm_journeys__journey_id__patch","parameters":[{"name":"journey_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Journey Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/journeys/{journey_id}/stages":{"post":{"tags":["Journeys"],"summary":"Add Journey Stage","description":"Add a stage to a journey","operationId":"add_journey_stage_api_v1_prm_journeys__journey_id__stages_post","parameters":[{"name":"journey_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Journey Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyStageCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyStageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/journeys/{journey_id}/stages/{stage_id}":{"patch":{"tags":["Journeys"],"summary":"Update Journey Stage","description":"Update a journey stage","operationId":"update_journey_stage_api_v1_prm_journeys__journey_id__stages__stage_id__patch","parameters":[{"name":"journey_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Journey Id"}},{"name":"stage_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Stage Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyStageUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyStageResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/instances":{"post":{"tags":["Journey Instances"],"summary":"Create Journey Instance","description":"Create a journey instance for a patient\n\nThis starts a patient on a specific journey, creating stage status tracking.","operationId":"create_journey_instance_api_v1_prm_instances_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyInstanceCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyInstanceResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Journey Instances"],"summary":"List Journey Instances","description":"List journey instances with filters","operationId":"list_journey_instances_api_v1_prm_instances_get","parameters":[{"name":"patient_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Patient Id"}},{"name":"journey_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyInstanceListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/instances/{instance_id}":{"get":{"tags":["Journey Instances"],"summary":"Get Journey Instance","description":"Get journey instance with stage statuses","operationId":"get_journey_instance_api_v1_prm_instances__instance_id__get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Instance Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyInstanceWithStages"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/instances/{instance_id}/advance":{"post":{"tags":["Journey Instances"],"summary":"Advance Journey Stage","description":"Advance journey to next stage\n\nMarks current stage as completed and moves to next stage in sequence.","operationId":"advance_journey_stage_api_v1_prm_instances__instance_id__advance_post","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Instance Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdvanceStageRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JourneyInstanceResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/communications":{"post":{"tags":["Communications"],"summary":"Create Communication","description":"Create and optionally send a communication\n\nSupports WhatsApp, SMS, Email, and other channels.\nCan be scheduled for future delivery.","operationId":"create_communication_api_v1_prm_communications_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommunicationCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommunicationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Communications"],"summary":"List Communications","description":"List communications with filters","operationId":"list_communications_api_v1_prm_communications_get","parameters":[{"name":"patient_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Patient Id"}},{"name":"journey_instance_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Instance Id"}},{"name":"channel","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Channel"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommunicationListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/tickets":{"post":{"tags":["Tickets"],"summary":"Create Ticket","description":"Create a support ticket\n\nTickets can be linked to journey instances for contextual support.","operationId":"create_ticket_api_v1_prm_tickets_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Tickets"],"summary":"List Tickets","description":"List tickets with filters","operationId":"list_tickets_api_v1_prm_tickets_get","parameters":[{"name":"patient_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Patient Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},{"name":"priority","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Priority"}},{"name":"assigned_to","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Assigned To"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/prm/tickets/{ticket_id}":{"patch":{"tags":["Tickets"],"summary":"Update Ticket","description":"Update a ticket","operationId":"update_ticket_api_v1_prm_tickets__ticket_id__patch","parameters":[{"name":"ticket_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Ticket Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AdvanceStageRequest":{"properties":{"force":{"type":"boolean","title":"Force","description":"Force advancement even if current stage is not completed","default":false},"notes":{"anyOf":[{"type":"string","maxLength":2000},{"type":"null"}],"title":"Notes"}},"type":"object","title":"AdvanceStageRequest","description":"Request to advance journey to next stage"},"CommunicationCreate":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"journey_instance_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Instance Id","description":"Link to journey instance if part of journey automation"},"channel":{"$ref":"#/components/schemas/CommunicationType"},"recipient":{"type":"string","title":"Recipient","description":"Phone number, email, or WhatsApp number"},"subject":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Subject"},"message":{"type":"string","maxLength":5000,"minLength":1,"title":"Message"},"template_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Template Name","description":"Template used for this communication"},"template_vars":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Template Vars","description":"Variables used in template"},"scheduled_for":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Scheduled For","description":"Schedule for future delivery"}},"type":"object","required":["tenant_id","patient_id","channel","recipient","message"],"title":"CommunicationCreate","description":"Schema for creating a communication","example":{"channel":"whatsapp","journey_instance_id":"journey-instance-uuid","message":"Your appointment is tomorrow at 10 AM","patient_id":"patient-uuid","recipient":"+1234567890","subject":"Appointment Reminder","template_name":"appointment_reminder","template_vars":{"appointment_time":"10:00 AM","doctor_name":"Dr. Smith","patient_name":"John Doe"},"tenant_id":"00000000-0000-0000-0000-000000000001"}},"CommunicationListResponse":{"properties":{"total":{"type":"integer","title":"Total"},"communications":{"items":{"$ref":"#/components/schemas/CommunicationResponse"},"type":"array","title":"Communications"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"},"has_next":{"type":"boolean","title":"Has Next"},"has_previous":{"type":"boolean","title":"Has Previous"}},"type":"object","required":["total","communications","page","page_size","has_next","has_previous"],"title":"CommunicationListResponse","description":"Response for list of communications"},"CommunicationResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"journey_instance_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Instance Id"},"channel":{"type":"string","title":"Channel"},"recipient":{"type":"string","title":"Recipient"},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject"},"message":{"type":"string","title":"Message"},"template_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Template Name"},"status":{"type":"string","title":"Status"},"scheduled_for":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Scheduled For"},"sent_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Sent At"},"delivered_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Delivered At"},"read_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Read At"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","patient_id","channel","recipient","message","status","created_at","updated_at"],"title":"CommunicationResponse","description":"Response schema for communication"},"CommunicationType":{"type":"string","enum":["whatsapp","sms","email","voice","in_app"],"title":"CommunicationType","description":"Communication channel type"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"JourneyCreate":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description"},"journey_type":{"$ref":"#/components/schemas/JourneyType"},"is_default":{"type":"boolean","title":"Is Default","description":"Auto-apply this journey when trigger conditions are met","default":false},"trigger_conditions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Trigger Conditions","description":"Conditions for auto-journey creation"},"stages":{"anyOf":[{"items":{"$ref":"#/components/schemas/JourneyStageCreate"},"type":"array"},{"type":"null"}],"title":"Stages","description":"Journey stages (can be added after journey creation)"}},"type":"object","required":["tenant_id","name","journey_type"],"title":"JourneyCreate","description":"Schema for creating a journey definition","example":{"description":"Standard outpatient visit journey","is_default":true,"journey_type":"opd","name":"OPD Visit Journey","stages":[{"name":"Pre-visit","order_index":0,"trigger_event":"Appointment.Created"},{"name":"Day of Visit","order_index":1,"trigger_event":"Appointment.CheckedIn"},{"name":"Post-visit","order_index":2,"trigger_event":"Encounter.Completed"}],"tenant_id":"00000000-0000-0000-0000-000000000001","trigger_conditions":{"appointment_type":"new"}}},"JourneyInstanceCreate":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"journey_id":{"type":"string","format":"uuid","title":"Journey Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"appointment_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Appointment Id","description":"Link to appointment that triggered this journey"},"encounter_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Encounter Id","description":"Link to encounter"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context","description":"Additional context data (e.g., patient preferences, special instructions)"}},"type":"object","required":["tenant_id","journey_id","patient_id"],"title":"JourneyInstanceCreate","description":"Schema for creating a journey instance","example":{"appointment_id":"appointment-uuid","context":{"language":"en","preferred_communication":"whatsapp","special_needs":"wheelchair_access"},"journey_id":"journey-uuid","patient_id":"patient-uuid","tenant_id":"00000000-0000-0000-0000-000000000001"}},"JourneyInstanceListResponse":{"properties":{"total":{"type":"integer","title":"Total"},"instances":{"items":{"$ref":"#/components/schemas/JourneyInstanceResponse"},"type":"array","title":"Instances"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"},"has_next":{"type":"boolean","title":"Has Next"},"has_previous":{"type":"boolean","title":"Has Previous"}},"type":"object","required":["total","instances","page","page_size","has_next","has_previous"],"title":"JourneyInstanceListResponse","description":"Response for list of journey instances"},"JourneyInstanceResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"journey_id":{"type":"string","format":"uuid","title":"Journey Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"appointment_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Appointment Id"},"encounter_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Encounter Id"},"status":{"type":"string","title":"Status"},"current_stage_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Current Stage Id"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context"},"started_at":{"type":"string","format":"date-time","title":"Started At"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","journey_id","patient_id","status","started_at","created_at","updated_at"],"title":"JourneyInstanceResponse","description":"Response schema for journey instance"},"JourneyInstanceWithStages":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"journey_id":{"type":"string","format":"uuid","title":"Journey Id"},"journey_name":{"type":"string","title":"Journey Name"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"status":{"type":"string","title":"Status"},"current_stage_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Current Stage Id"},"started_at":{"type":"string","format":"date-time","title":"Started At"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At"},"stages":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Stages","description":"List of stages with their current status"}},"type":"object","required":["id","tenant_id","journey_id","journey_name","patient_id","status","started_at"],"title":"JourneyInstanceWithStages","description":"Journey instance with stage statuses"},"JourneyListResponse":{"properties":{"total":{"type":"integer","title":"Total"},"journeys":{"items":{"$ref":"#/components/schemas/JourneyResponse"},"type":"array","title":"Journeys"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"},"has_next":{"type":"boolean","title":"Has Next"},"has_previous":{"type":"boolean","title":"Has Previous"}},"type":"object","required":["total","journeys","page","page_size","has_next","has_previous"],"title":"JourneyListResponse","description":"Response for list of journeys"},"JourneyResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"journey_type":{"type":"string","title":"Journey Type"},"is_default":{"type":"boolean","title":"Is Default"},"trigger_conditions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Trigger Conditions"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"stages":{"items":{"$ref":"#/components/schemas/JourneyStageResponse"},"type":"array","title":"Stages","default":[]}},"type":"object","required":["id","tenant_id","name","journey_type","is_default","created_at","updated_at"],"title":"JourneyResponse","description":"Response schema for journey definition"},"JourneyStageCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description"},"order_index":{"type":"integer","minimum":0.0,"title":"Order Index"},"trigger_event":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Trigger Event","description":"Event that triggers advancement to this stage"},"actions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Actions","description":"Actions to perform when stage is entered (e.g., send communication)"}},"type":"object","required":["name","order_index"],"title":"JourneyStageCreate","description":"Schema for creating a journey stage","example":{"actions":{"send_communication":{"channel":"whatsapp","template":"pre_visit_instructions"}},"description":"Send pre-visit instructions and forms","name":"Pre-visit Prep","order_index":0,"trigger_event":"Appointment.Created"}},"JourneyStageResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"journey_id":{"type":"string","format":"uuid","title":"Journey Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"order_index":{"type":"integer","title":"Order Index"},"trigger_event":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Trigger Event"},"actions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Actions"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","journey_id","name","order_index","created_at","updated_at"],"title":"JourneyStageResponse","description":"Response schema for journey stage"},"JourneyStageUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"order_index":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Order Index"},"trigger_event":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Trigger Event"},"actions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Actions"}},"type":"object","title":"JourneyStageUpdate","description":"Schema for updating a journey stage"},"JourneyType":{"type":"string","enum":["opd","ipd","procedure","chronic_care","wellness"],"title":"JourneyType","description":"Journey type enumeration"},"JourneyUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"is_default":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Default"},"trigger_conditions":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Trigger Conditions"}},"type":"object","title":"JourneyUpdate","description":"Schema for updating a journey definition"},"TicketCreate":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"journey_instance_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Instance Id","description":"Link to journey instance if ticket is journey-related"},"title":{"type":"string","maxLength":255,"minLength":1,"title":"Title"},"description":{"type":"string","maxLength":5000,"minLength":1,"title":"Description"},"priority":{"$ref":"#/components/schemas/TicketPriority","default":"medium"},"category":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Category","description":"Ticket category (e.g., billing, clinical, administrative)"},"assigned_to":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Assigned To","description":"Staff member UUID"}},"type":"object","required":["tenant_id","patient_id","title","description"],"title":"TicketCreate","description":"Schema for creating a support ticket","example":{"category":"administrative","description":"Patient requires wheelchair for appointment tomorrow","journey_instance_id":"journey-instance-uuid","patient_id":"patient-uuid","priority":"high","tenant_id":"00000000-0000-0000-0000-000000000001","title":"Need wheelchair assistance"}},"TicketListResponse":{"properties":{"total":{"type":"integer","title":"Total"},"tickets":{"items":{"$ref":"#/components/schemas/TicketResponse"},"type":"array","title":"Tickets"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"},"has_next":{"type":"boolean","title":"Has Next"},"has_previous":{"type":"boolean","title":"Has Previous"}},"type":"object","required":["total","tickets","page","page_size","has_next","has_previous"],"title":"TicketListResponse","description":"Response for list of tickets"},"TicketPriority":{"type":"string","enum":["low","medium","high","urgent"],"title":"TicketPriority","description":"Ticket priority levels"},"TicketResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"patient_id":{"type":"string","format":"uuid","title":"Patient Id"},"journey_instance_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Journey Instance Id"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"status":{"type":"string","title":"Status"},"priority":{"type":"string","title":"Priority"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"},"assigned_to":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Assigned To"},"resolution_notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resolution Notes"},"resolved_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Resolved At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","patient_id","title","description","status","priority","created_at","updated_at"],"title":"TicketResponse","description":"Response schema for ticket"},"TicketStatus":{"type":"string","enum":["open","in_progress","resolved","closed"],"title":"TicketStatus","description":"Ticket status"},"TicketUpdate":{"properties":{"title":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"status":{"anyOf":[{"$ref":"#/components/schemas/TicketStatus"},{"type":"null"}]},"priority":{"anyOf":[{"$ref":"#/components/schemas/TicketPriority"},{"type":"null"}]},"assigned_to":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Assigned To"},"resolution_notes":{"anyOf":[{"type":"string","maxLength":2000},{"type":"null"}],"title":"Resolution Notes"}},"type":"object","title":"TicketUpdate","description":"Schema for updating a ticket"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}